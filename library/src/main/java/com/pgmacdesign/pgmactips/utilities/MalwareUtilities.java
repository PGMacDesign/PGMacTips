package com.pgmacdesign.pgmactips.utilities;

import android.content.Context;
import android.content.pm.ApplicationInfo;
import android.content.pm.PackageManager;
import android.support.annotation.NonNull;

import com.pgmacdesign.pgmactips.misc.PGMacTipsConstants;

import java.util.ArrayList;
import java.util.List;

/**
 * Created by pmacdowell on 2017-06-16.
 */

public class MalwareUtilities {

    /**
     * Checks for malware apps via a list of known malware package strings.
     * For the list, see {@link PGMacTipsConstants#MALWARE_PACKAGE_STRINGS}
     * Pulled from: https://arstechnica.com/security/2017/06/google-play-is-fighting-an-uphill-battle-against-android-adware/
     * @param context Context, needed for package manager
     * @return List of Strings. This list contains the installed packages. If there are
     *         none of the packages found on the device, an empty list will be returned.
     */
    public static List<String> checkForMalware(@NonNull Context context){
        List<String> lst = new ArrayList<>();
        for(String s : PGMacTipsConstants.MALWARE_PACKAGE_STRINGS){
            try{
                ApplicationInfo info = context.getPackageManager().getApplicationInfo(s, 0);
                String ss = info.packageName;
                if(StringUtilities.isNullOrEmpty(ss)){
                    ss = s;
                }
                lst.add(ss);
            } catch(PackageManager.NameNotFoundException e ){
                //Not on device, don't add.
            } catch(Exception e){
                e.printStackTrace();
            }
        }
        return lst;
    }
}
